summarize(catch_total=sum(catch, na.rm=T)) %>%
arrange(desc(catch_total))
fisheries_tidy_focused %>%
filter(str_detect(isscaap_taxonomic_group, "Squids")) %>%
filter(year>=2008 & year<=2012) %>%
group_by(country) %>%
summarize(catch_total=sum(catch, na.rm=T)) %>%
arrange(desc(catch_total))
fisheries_tidy_focused %>%
filter(isscaap_taxonomic_group=="Squids, cuttlefishes, octopuses") %>%
count(asfis_species_name, sort=T)
fisheries_tidy_focused %>%
filter(year>=2008 & year<=2012)%>%
group_by(asfis_species_name) %>%
summarize(catch_total=sum(catch, na.rm=T)) %>%
arrange(desc(catch_total))
new_fish %>%
group_by(country) %>%
filter(between(year, 2008, 2012)) %>%
filter(isscaap_taxonomic_group=="Squids, cuttlefishes, octopuses") %>%
summarize(topfive = sum(catch, na.rm=T)) %>%
arrange(desc(topfive))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(janitor)
library(skimr)
fisheries <- readr::read_csv(file = "data/FAO_1950to2012_111914.csv")
names(fisheries)
dim(fisheries)
anyNA(fisheries)
glimpse(fisheries)
library("janitor")
fisheries <- clean_names(fisheries)
names(fisheries)
fisheries$country <- as.factor(fisheries$country)
fisheries$isscaap_group_number <- as.factor(fisheries$isscaap_group_number)
fisheries$asfis_species_number <- as.factor(fisheries$asfis_species_number)
fisheries$fao_major_fishing_area <- as.factor(fisheries$fao_major_fishing_area)
fisheries_tidy <- fisheries %>%
pivot_longer(-c(country,common_name,isscaap_group_number,isscaap_taxonomic_group,asfis_species_number,asfis_species_name,fao_major_fishing_area,measure),
names_to = "year",
values_to = "catch",
values_drop_na = TRUE) %>%
mutate(year= as.numeric(str_replace(year, 'x', ''))) %>%
mutate(catch= str_replace(catch, c(' F'), replacement = '')) %>%
mutate(catch= str_replace(catch, c('...'), replacement = '')) %>%
mutate(catch= str_replace(catch, c('-'), replacement = '')) %>%
mutate(catch= str_replace(catch, c('0 0'), replacement = ''))
fisheries_tidy$catch <- as.numeric(fisheries_tidy$catch)
fisheries_tidy %>%
count(country, sort=T) %>% #this give the number and the name of the countries
summarize(countries = n_distinct(country)) #this give the number of countries
new_fish <- fisheries_tidy %>%
select(country,isscaap_taxonomic_group,asfis_species_name,asfis_species_number,year,catch)
new_fish %>%
summarize(catches = n_distinct(asfis_species_number))
new_fish %>%
group_by(country) %>%
filter(year == 2000) %>%
summarize(largest = sum(catch, na.rm=T)) %>%
arrange(desc(largest))
new_fish %>%
group_by(country) %>%
filter(between(year, 1990, 2000)) %>%
filter(asfis_species_name == "Sardina pilchardus") %>%
summarize(caught = sum(catch, na.rm = T)) %>% #if you dont use sum, you will have values that are not added up / spread out data
arrange(desc(caught))
new_fish %>%
group_by(country) %>%
filter(between(year, 2008, 2012)) %>%
filter(isscaap_taxonomic_group=="Squids, cuttlefishes, octopuses") %>%
summarize(topfive = sum(catch, na.rm=T)) %>%
arrange(desc(topfive))
new_fish %>%
group_by(asfis_species_name) %>%
filter(between(year, 2008, 2012)) %>%
summarize(top = sum(catch, na.rm=T)) %>%
arrange(desc(top))
new_fish %>%
group_by(asfis_species_name) %>%
filter(year == 2008) %>%
summarize(mean_ca = mean(catch, na.rm = T))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(janitor)
library(skimr)
fisheries <- readr::read_csv(file = "data/FAO_1950to2012_111914.csv")
names(fisheries)
dim(fisheries)
anyNA(fisheries)
glimpse(fisheries)
library("janitor")
fisheries <- clean_names(fisheries)
names(fisheries)
fisheries$country <- as.factor(fisheries$country)
fisheries$isscaap_group_number <- as.factor(fisheries$isscaap_group_number)
fisheries$asfis_species_number <- as.factor(fisheries$asfis_species_number)
fisheries$fao_major_fishing_area <- as.factor(fisheries$fao_major_fishing_area)
fisheries_tidy <- fisheries %>%
pivot_longer(-c(country,common_name,isscaap_group_number,isscaap_taxonomic_group,asfis_species_number,asfis_species_name,fao_major_fishing_area,measure),
names_to = "year",
values_to = "catch",
values_drop_na = TRUE) %>%
mutate(year= as.numeric(str_replace(year, 'x', ''))) %>%
mutate(catch= str_replace(catch, c(' F'), replacement = '')) %>%
mutate(catch= str_replace(catch, c('...'), replacement = '')) %>%
mutate(catch= str_replace(catch, c('-'), replacement = '')) %>%
mutate(catch= str_replace(catch, c('0 0'), replacement = ''))
fisheries_tidy$catch <- as.numeric(fisheries_tidy$catch)
fisheries_tidy %>%
count(country, sort=T) %>% #this give the number and the name of the countries
summarize(countries = n_distinct(country)) #this give the number of countries
new_fish <- fisheries_tidy %>%
select(country,isscaap_taxonomic_group,asfis_species_name,asfis_species_number,year,catch)
new_fish %>%
summarize(catches = n_distinct(asfis_species_number))
new_fish %>%
group_by(country) %>%
filter(year == 2000) %>%
summarize(largest = sum(catch, na.rm=T)) %>%
arrange(desc(largest))
new_fish %>%
group_by(country) %>%
filter(between(year, 1990, 2000)) %>%
filter(asfis_species_name == "Sardina pilchardus") %>%
summarize(caught = sum(catch, na.rm = T)) %>% #if you dont use sum, you will have values that are not added up / spread out data
arrange(desc(caught))
new_fish %>%
group_by(country) %>%
filter(between(year, 2008, 2012)) %>%
filter(asfis_species_name == "Cephalopoda") %>%
summarize(topfive = sum(catch, na.rm=T)) %>%
arrange(desc(topfive))
new_fish %>%
group_by(asfis_species_name) %>%
filter(between(year, 2008, 2012)) %>%
summarize(top = sum(catch, na.rm=T)) %>%
arrange(desc(top))
new_fish %>%
group_by(asfis_species_name) %>%
filter(year == 2008) %>%
summarize(mean_ca = mean(catch, na.rm = T))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(janitor)
library(tidyverse)
library(janitor)
ecosphere <- read_csv("data/ecs21351-sup-0003-SupplementS1.csv", skip=2) %>%
clean_names() %>%
slice(1:(n() - 18)) # this removes the footer
names(ecosphere)
glimpse(ecosphere)
ecosphere <- n_distinct(ecosphere)
ecosphere <- n_distinct(ecosphere$order)
n_distinct(ecosphere$order)
n_distinct(ecosphere,order)
ecosphere <- n_distinct(ecosphere,order)
ecosphere %>%
n_distinct(order)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(janitor)
ecosphere <- read_csv("data/ecs21351-sup-0003-SupplementS1.csv", skip=2) %>%
clean_names() %>%
slice(1:(n() - 18)) # this removes the footer
names(ecosphere)
glimpse(ecosphere)
ecosphere %>%
n_distinct(order)
ecosphere %>%
n_distinct(order)
ecosphere %>%
n_distinct(ecosphere$order)
n_distinct(ecosphere$order)
n_distinct(ecosphere$order)
table(ecosphere$habitat)
slice_max
slice_max()
slice_max
slice_min(ecosphere$winter_range_area)
ecosphere %>%
select(scientific_name,winter_range_area) %>%
slice_max(winter_range_area)
ecosphere %>%
select(scientific_name,winter_range_area) %>%
slice_min(winter_range_area)
ducks <- ecosphere %>%
filter(family == "Anatidae") %>%
select(-"order", -"family")
ducks
ecosphere %>%
summarize(across(contains("duck"),mean))
ecosphere %>%
summarize(across(contains("duck"), n_distinct))
ecosphere %>%
summarize(across(contains("duck"), n_distinct))
ecosphere %>%
filter(common_name == "duck")
ecosphere %>%
filter(common_name,contains( "duck"))
ducks %>%
summarize(across(contains("duck"),mean))
ducks %>%
summarize(across(contains("duck"),mean))
ducks %>%
table(habitat)
ducks %>%
table(habitat)
ducks %>%
tabyl(habitat)
ducks %>%
filter(habitat == "Ocean")
ducks %>%
group_by(migratory_strategy) %>%
summarize(avg_body = mean(log10_mass, na.rm = T),
n=n())
eagles <- ecosphere %>%
filter(family = "Accipitridae") %>%
select(common_name,scientific_name,population_size)
eagles <- ecosphere %>%
filter(family == "Accipitridae") %>%
select(common_name,scientific_name,population_size)
summary(eagles)
eagles %>%
mutate(population_size < 250000 = "Threatened") %>%
eagles %>%
mutate(conservation_status = ifelse(population_size < 250000))
??mutate
mutate()
?mutate
eagles %>%
group_by(population_size) %>%
mutate(conservation_status = ifelse(population_size < 250000))
eagles %>%
group_by(population_size) %>%
mutate(conservation_status = population_size < 250000)
eagles %>%
group_by(population_size) %>%
mutate(conservation_status = population_size < 250000, na.rm=T) %>%
```
eagles %>%
group_by(population_size) %>%
filter(!is.na(population_size)) %>%
mutate(conservation_status = population_size < 250000)
eagles %>%
group_by(population_size) %>%
filter(!is.na(population_size)) %>%
mutate(conservation_status = population_size < 250000) %>%
filter(conservation_status == "TRUE")
knitr::opts_chunk$set(echo = TRUE)
tabyl(elephants$sex)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
elephants<-readr::read_csv("data/ElephantsMF.csv")
glimpse(elephants)
names(elephants)
## The class of Age and Height is 'double precision floating point' and the class of Sex is 'character'.
elephants <- janitor::clean_names(elephants)
names(elephants)
elephants$sex <- as.factor(elephants$sex)
glimpse(elephants)
vertebrates<-readr::read_csv("data/IvindoData_DryadVersion.csv")
glimpse(vertebrates)
names(vertebrates)
vertebrates$HuntCat <- as.factor(vertebrates$HuntCat)
vertebrates$LandUse <- as.factor(vertebrates$LandUse)
tabyl(elephants$sex)
table(elephants$sex)
mean(elephants$age)
mean(elephants$age, na.rm = T)
mean(elephants$age, na.rm = T)
elephants %>%
group_by(sex) %>%
summarize(avg_age = mean(age, na.rm = T),
avg_height = mean(height, na.rm=T),
n=n())
elephants %>%
group_by(sex) %>%
filter(age > 25)
summarize(avg_height = mean(height, na.rm=T),
n=n())
elephants %>%
group_by(sex) %>%
filter(age > 25) %>%
summarize(avg_height = mean(height, na.rm=T),
n=n())
n=n())
(min_height = min(height, na.rm=T)
(min_height = min(height, na.rm=T)
For the next series of questions, we will use data from a study on vertebrate community composition and impacts from defaunation in [Gabon, Africa](https://en.wikipedia.org/wiki/Gabon). One thing to notice is that the data include 24 separate transects. Each transect represents a path through different forest management areas.
total = n())
elephants %>%
group_by(sex) %>%
filter(age > 25) %>%
summarize(avg_height = mean(height, na.rm=T),
max_height = max(height, na.rm=T),
min_height = min(height, na.rm=T)
total = n())
elephants %>%
group_by(sex) %>%
filter(age > 25) %>%
summarize(avg_height = mean(height, na.rm=T),
max_height = max(height, na.rm=T),
min_height = min(height, na.rm=T),
total = n())
vertebrates %>%
filter(HuntCat = "Moderate") %>%
summarize(avg_bird = mean(Diversity_BirdSpecies, na.rm = T),
avg_mam = mean(Diversity_MammalSpecies, na.rm = T),
total=n())
vertebrates %>%
filter(HuntCat == "Moderate") %>%
summarize(avg_bird = mean(Diversity_BirdSpecies, na.rm = T),
avg_mam = mean(Diversity_MammalSpecies, na.rm = T),
total=n())
vertebrates %>%
filter(HuntCat == "High") %>%
summarize(avg_bird = mean(Diversity_BirdSpecies, na.rm = T),
avg_mam = mean(Diversity_MammalSpecies, na.rm = T),
total=n())
vertebrates %>%
group_by(HuntCat)
vertebrates %>%
filter(HuntCat == "High") %>%
group_by(HuntCat)
vertebrates %>%
filter(HuntCat == "High") %>%
summarize(avg_bird = mean(Diversity_BirdSpecies, na.rm = T),
avg_mam = mean(Diversity_MammalSpecies, na.rm = T),
total=n())
vertebrates %>%
filter(Distance < 5)
vertebrates %>%
filter(Distance < 5) %>%
mutate(across(contains("RA_"), mean)))
vertebrates %>%
filter(Distance < 5) %>%
mutate(across(contains("RA_"), mean))
vertebrates %>%
filter(Distance >20) %>%
mutate(across(contains("RA_"), mean))
vertebrates %>%
filter(Distance < 5) %>%
group_by(across(contains("RA_"), mean))
filter(Distance < 5) %>%
```
vertebrates %>%
filter(Distance < 5) %>%
group_by(across(contains("RA_"), mean))
vertebrates %>%
filter(Distance < 5) %>%
summarize(across(contains("RA_"), mean))
vertebrates %>%
filter(Distance >20) %>%
summarize(across(contains("RA_"), mean))
fisheries_tidy %>%
n_distinct(country)) #this give the number of countries
n_distinct(fisheries$country)) #this give the number of countries
n_distinct(fisheries$country) #this give the number of countries
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(janitor)
library(skimr)
fisheries <- readr::read_csv(file = "data/FAO_1950to2012_111914.csv")
names(fisheries)
dim(fisheries)
anyNA(fisheries)
glimpse(fisheries)
library("janitor")
fisheries <- clean_names(fisheries)
names(fisheries)
fisheries$country <- as.factor(fisheries$country)
fisheries$isscaap_group_number <- as.factor(fisheries$isscaap_group_number)
fisheries$asfis_species_number <- as.factor(fisheries$asfis_species_number)
fisheries$fao_major_fishing_area <- as.factor(fisheries$fao_major_fishing_area)
fisheries_tidy <- fisheries %>%
pivot_longer(-c(country,common_name,isscaap_group_number,isscaap_taxonomic_group,asfis_species_number,asfis_species_name,fao_major_fishing_area,measure),
names_to = "year",
values_to = "catch",
values_drop_na = TRUE) %>%
mutate(year= as.numeric(str_replace(year, 'x', ''))) %>%
mutate(catch= str_replace(catch, c(' F'), replacement = '')) %>%
mutate(catch= str_replace(catch, c('...'), replacement = '')) %>%
mutate(catch= str_replace(catch, c('-'), replacement = '')) %>%
mutate(catch= str_replace(catch, c('0 0'), replacement = ''))
fisheries_tidy$catch <- as.numeric(fisheries_tidy$catch)
n_distinct(fisheries$country) #this give the number of countries
new_fish <- fisheries_tidy %>%
select(country,isscaap_taxonomic_group,asfis_species_name,asfis_species_number,year,catch)
new_fish %>%
summarize(catches = n_distinct(asfis_species_number))
new_fish %>%
group_by(country) %>%
filter(year == 2000) %>%
summarize(largest = sum(catch, na.rm=T)) %>%
arrange(desc(largest))
new_fish %>%
group_by(country) %>%
filter(between(year, 1990, 2000)) %>%
filter(asfis_species_name == "Sardina pilchardus") %>%
summarize(caught = sum(catch, na.rm = T)) %>% #if you dont use sum, you will have values that are not added up / spread out data
arrange(desc(caught))
new_fish %>%
group_by(country) %>%
filter(between(year, 2008, 2012)) %>%
filter(asfis_species_name == "Cephalopoda") %>%
summarize(topfive = sum(catch, na.rm=T)) %>%
arrange(desc(topfive))
new_fish %>%
group_by(asfis_species_name) %>%
filter(between(year, 2008, 2012)) %>%
summarize(top = sum(catch, na.rm=T)) %>%
arrange(desc(top))
new_fish %>%
group_by(asfis_species_name) %>%
filter(year == 2008) %>%
summarize(mean_ca = mean(catch, na.rm = T))
n_distinct(fisheries_tidy$country) #this give the number of countries
names(country)
colnames(country)
n_distinct(fisheries_tidy$country) #this give the number of countries
levels(fisheries_tidy$country)
?levels()
View(fisheries_tidy)
View(new_fish)
View(fisheries)
new_fish %>%
group_by(country) %>%
filter(year>=2008 & year<=2012) %>%
filter(asfis_species_name == "Cephalopoda") %>%
summarize(topfive = sum(catch, na.rm=T)) %>%
arrange(desc(topfive))
new_fish %>%
filter(year>=2008 & year<=2012) %>%
group_by(country) %>%
filter(asfis_species_name == "Cephalopoda") %>%
summarize(topfive = sum(catch, na.rm=T)) %>%
arrange(desc(topfive))
new_fish %>%
filter(str_detect(isscaap_taxonomic_group, "Squids")) %>%
filter(year>=2008 & year<=2012) %>%
group_by(country) %>%
summarize(catch_total=sum(catch, na.rm=T)) %>%
arrange(desc(catch_total))
View(new_fish)
new_fish %>%
filter(year>=2008 & year<=2012) %>%
group_by(country) %>%
filter(asfis_species_name == "Cephalopoda") %>%
summarize(topfive = sum(catch, na.rm=T)) %>%
arrange(desc(topfive))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(janitor)
library(skimr)
fisheries <- readr::read_csv(file = "data/FAO_1950to2012_111914.csv")
names(fisheries)
dim(fisheries)
anyNA(fisheries)
glimpse(fisheries)
library("janitor")
fisheries <- clean_names(fisheries)
names(fisheries)
fisheries$country <- as.factor(fisheries$country)
fisheries$isscaap_group_number <- as.factor(fisheries$isscaap_group_number)
fisheries$asfis_species_number <- as.factor(fisheries$asfis_species_number)
fisheries$fao_major_fishing_area <- as.factor(fisheries$fao_major_fishing_area)
fisheries_tidy <- fisheries %>%
pivot_longer(-c(country,common_name,isscaap_group_number,isscaap_taxonomic_group,asfis_species_number,asfis_species_name,fao_major_fishing_area,measure),
names_to = "year",
values_to = "catch",
values_drop_na = TRUE) %>%
mutate(year= as.numeric(str_replace(year, 'x', ''))) %>%
mutate(catch= str_replace(catch, c(' F'), replacement = '')) %>%
mutate(catch= str_replace(catch, c('...'), replacement = '')) %>%
mutate(catch= str_replace(catch, c('-'), replacement = '')) %>%
mutate(catch= str_replace(catch, c('0 0'), replacement = ''))
fisheries_tidy$catch <- as.numeric(fisheries_tidy$catch)
n_distinct(fisheries_tidy$country) #this give the number of countries
levels(fisheries_tidy$country)
new_fish <- fisheries_tidy %>%
select(country,isscaap_taxonomic_group,asfis_species_name,asfis_species_number,year,catch)
new_fish %>%
summarize(catches = n_distinct(asfis_species_number))
new_fish %>%
group_by(country) %>%
filter(year == 2000) %>%
summarize(largest = sum(catch, na.rm=T)) %>%
arrange(desc(largest))
new_fish %>%
group_by(country) %>%
filter(between(year, 1990, 2000)) %>%
filter(asfis_species_name == "Sardina pilchardus") %>%
summarize(caught = sum(catch, na.rm = T)) %>% #if you dont use sum, you will have values that are not added up / spread out data
arrange(desc(caught))
new_fish %>%
filter(year>=2008 & year<=2012) %>%
group_by(country) %>%
filter(asfis_species_name == "Cephalopoda") %>%
summarize(topfive = sum(catch, na.rm=T)) %>%
arrange(desc(topfive))
new_fish %>%
select()
group_by(asfis_species_name) %>%
filter(between(year, 2008, 2012)) %>%
summarize(top = sum(catch, na.rm=T)) %>%
arrange(desc(top))
new_fish %>%
group_by(asfis_species_name) %>%
filter(between(year, 2008, 2012)) %>%
summarize(top = sum(catch, na.rm=T)) %>%
arrange(desc(top))
