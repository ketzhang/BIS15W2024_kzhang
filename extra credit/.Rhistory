filter(year >= 1950)
global_sharks %>%
filter(country == "USA") %>%
filter(year >= 1950) %>%
count(area)
global_sharks %>%
filter(country == "USA") %>%
filter(year >= 1950) %>%
count(area) %>%
arrange(desc(n))
global_sharks %>%
filter(country == "USA") %>%
filter(year >= 1950) %>%
count(area) %>%
arrange(desc(n)) %>%
head(5)
global_sharks %>%
filter(country == "USA") %>%
filter(year >= 1950) %>%
count(area) %>%
arrange(desc(n)) %>%
head(5) %>%
ggplot(aes(x = area, y = n, fill = area))+
geom_col()+
labs(title = "Incidents in USA",
x = "States",
y = "Number of incidents",
fill = "States")
global_sharks %>%
filter(country == "USA") %>%
filter(year >= 1950) %>%
count(area) %>%
arrange(desc(n)) %>%
head(5) %>%
ggplot(aes(x = area, y = n, fill = area))+
geom_col()+
coord_flip()+
labs(title = "Incidents in USA",
x = "States",
y = "Number of incidents",
fill = "States")
white_shark <- global_sharks %>%
filter(species = "White shark")
white_shark <- global_sharks %>%
filter(species == "White shark")
white_shark <- global_sharks %>%
filter(str_detect(species, pattern = ("White shark")))
View(white_shark)
white_shark <- global_sharks %>%
filter(str_detect(species, pattern = ("White"))) %>%
count(country)
white_shark <- global_sharks %>%
filter(str_detect(species, pattern = ("White"))) %>%
count(country)
View(white_shark)
white_shark <- global_sharks %>%
filter(str_detect(species, pattern = ("White")))
white_shark %>%
count(country) %>%
arrange(desc(n))
white_shark %>%
count(country) %>%
arrange(desc(n)) %>%
head(5)
View(white_shark)
white_shark %>%
count(country) %>%
arrange(desc(n)) %>%
head(5) %>%
filter(fatal_y_n == "Y" | fatal_y_n == "N")
white_shark %>%
filter(fatal_y_n == "Y" | fatal_y_n == "N") %>%
count(country) %>%
arrange(desc(n)) %>%
head(5)
white_shark %>%
filter(fatal_y_n == "Y" | fatal_y_n == "N") %>%
count(country) %>%
arrange(desc(n)) %>%
head(5) %>%
ggplot(aes(x = country, y = n))+
geom_col()+
facet_wrap(~country)
white_shark %>%
filter(fatal_y_n == "Y" | fatal_y_n == "N") %>%
count(country) %>%
arrange(desc(n)) %>%
head(5) %>%
ggplot(aes(x = country))+
geom_bar()+
facet_wrap(~country)
white_shark %>%
filter(fatal_y_n == "Y" | fatal_y_n == "N") %>%
count(country) %>%
arrange(desc(n)) %>%
head(5) %>%
ggplot(aes(x = fatal_y_n))+
geom_bar()+
facet_wrap(~country)
white_shark %>%
filter(fatal_y_n == "Y" | fatal_y_n == "N") %>%
count(country) %>%
arrange(desc(n)) %>%
head(5) %>%
ggplot(aes(x = fatal_y_n))+
geom_bar()+
facet_wrap(~country)
white_shark %>%
count(country) %>%
arrange(desc(n)) %>%
head(5) %>%
filter(fatal_y_n == "Y" | fatal_y_n == "N") %>%
ggplot(aes(x = fatal_y_n))+
geom_bar()+
facet_wrap(~country)
white_shark %>%
count(country) %>%
arrange(desc(n)) %>%
head(5) %>%
filter(fatal_y_n == "Y" | fatal_y_n == "N") %>%
ggplot(aes(x = fatal_y_n))+
geom_bar()+
facet_wrap(~country)
white_shark %>%
count(country) %>%
arrange(desc(n)) %>%
head(5, country) %>%
filter(fatal_y_n == "Y" | fatal_y_n == "N") %>%
ggplot(aes(x = fatal_y_n))+
geom_bar()+
facet_wrap(~country)
white_shark %>%
filter(fatal_y_n == "Y" | fatal_y_n == "N") %>%
count(country) %>%
arrange(desc(n)) %>%
head(5, country) %>%
ggplot(aes(x = fatal_y_n))+
geom_bar()+
facet_wrap(~country)
white_shark %>%
filter(fatal_y_n == "Y" | fatal_y_n == "N") %>%
group_by(country, fatal_y_n) %>%  # Add group_by here
count() %>%
arrange(desc(n)) %>%
head(5) %>%
ggplot(aes(x = fatal_y_n))+
geom_bar()+
facet_wrap(~country)
white_shark %>%
filter(fatal_y_n == "Y" | fatal_y_n == "N") %>%
group_by(country, fatal_y_n) %>%  # Add group_by here
count(country) %>%
arrange(desc(n)) %>%
head(5) %>%
ggplot(aes(x = fatal_y_n))+
geom_bar()+
facet_wrap(~country)
white_shark %>%
filter(fatal_y_n == "Y" | fatal_y_n == "N") %>%
group_by(country, fatal_y_n) %>%
count(country) %>%
arrange(desc(n)) %>%
head(5)
white_shark %>%
filter(fatal_y_n == "Y" | fatal_y_n == "N") %>%
group_by(country, fatal_y_n) %>%
count(country) %>%
arrange(desc(n)) %>%
head(5) %>%
ggplot(aes(x = fatal_y_n))+
geom_bar()
white_shark %>%
filter(fatal_y_n == "Y" | fatal_y_n == "N") %>%
count(country) %>%
arrange(desc(n)) %>%
head(5) %>%
ggplot(aes(x = fatal_y_n))+
geom_bar()+
facet_wrap(~country)
library("tidyverse")
library("janitor")
library("naniar")
global_sharks <- read_csv("data/global-shark-attack.csv") %>% clean_names()
str(global_sharks)
miss_var_summary(global_sharks)
global_sharks %>%
count(country) %>%
arrange(desc(n))
global_sharks %>%
count(country) %>%
arrange(desc(n))%>%
top_n(10, n) %>%
ggplot(aes(x=country, y=n, fill = country))+
geom_col()+
coord_flip()+
theme_light()+
labs(title = "Hotspots of shark incidents",
x = "Country",
y = "Number of incidents",
fill = "Country")
global_sharks %>%
separate(date, into= c("year", "month", "day"), sep = "-") %>%
mutate(month = as.factor(month)) %>%
filter(month != "NA") %>%
count(month) %>%
arrange(desc(n))
global_sharks %>%
separate(date, into= c("year", "month", "day"), sep = "-") %>%
mutate(month = as.factor(month)) %>%
filter(month != "NA") %>%
count(month) %>%
arrange(desc(n)) %>%
ggplot(aes(x = month, y=n, fill = month))+
geom_col(na.rm = TRUE)+
theme_light()+
labs(title = "Incidents by month",
x = "Month",
y = "Number of incidents",
fill = "Month")
global_sharks %>%
filter(activity != "NA") %>%
count(activity) %>%
arrange(desc(n))
global_sharks %>%
filter(activity != "NA") %>%
count(activity) %>%
arrange(desc(n)) %>%
head(5, activity) %>%
ggplot(aes(x=activity, y=n, fill = activity))+
geom_col()+
coord_flip()
global_sharks %>%
group_by(sex) %>%
filter(sex == "M" | sex == "F") %>%
filter(injury == "FATAL") %>%
count(injury)
global_sharks %>%
group_by(sex) %>%
filter(sex == "M" | sex == "F") %>%
filter(injury == "FATAL") %>%
count(injury) %>%
ggplot(aes(x=sex, y=n, fill = sex))+
geom_col()+
labs(title = "Incidents group by sex",
x = "Sex",
y = "Number of incidents",
fill = "Sex")
global_sharks %>%
filter(sex == "M" | sex == "F") %>%
mutate(age = as.integer(age)) %>%
filter(age != "NA") %>%
ggplot(aes(x = sex, y = age, filter = sex))+
geom_boxplot(na.rm =T)+
labs(title = "Incidents group by age range",
x = "Sex",
y = "Age range",
fill = "Sex")
global_sharks %>%
filter(country == "USA") %>%
filter(year >= 1950) %>%
count(area) %>%
arrange(desc(n)) %>%
head(5)
global_sharks %>%
filter(country == "USA") %>%
filter(year >= 1950) %>%
count(area) %>%
arrange(desc(n)) %>%
head(5) %>%
ggplot(aes(x = area, y = n, fill = area))+
geom_col()+
coord_flip()+
labs(title = "Incidents in USA",
x = "States",
y = "Number of incidents",
fill = "States")
white_shark <- global_sharks %>%
filter(str_detect(species, pattern = ("White")))
white_shark %>%
count(country) %>%
arrange(desc(n))
white_shark %>%
filter(fatal_y_n == "Y" | fatal_y_n == "N") %>%
count(country) %>%
arrange(desc(n)) %>%
head(5) %>%
ggplot(aes(x = fatal_y_n))+
geom_bar()+
facet_wrap(~country)
white_sharks %>%
filter(country=="USA" | country=="AUSTRALIA"|country=="SOUTH AFRICA"|country=="NEW ZEALAND"|country=="ITALY") %>%
filter(fatal_y_n=="Y" | fatal_y_n=="N") %>%
ggplot(aes(x=fatal_y_n))+
geom_bar(fill="deepskyblue4", alpha=0.7)+
facet_wrap(~country)+
white_sharks %>%
filter(country=="USA" | country=="AUSTRALIA"|country=="SOUTH AFRICA"|country=="NEW ZEALAND"|country=="ITALY") %>%
filter(fatal_y_n=="Y" | fatal_y_n=="N") %>%
ggplot(aes(x=fatal_y_n))+
geom_bar(fill="deepskyblue4", alpha=0.7)+
facet_wrap(~country)
white_shark %>%
filter(country=="USA" | country=="AUSTRALIA"|country=="SOUTH AFRICA"|country=="NEW ZEALAND"|country=="ITALY") %>%
filter(fatal_y_n=="Y" | fatal_y_n=="N") %>%
ggplot(aes(x=fatal_y_n))+
geom_bar(fill="deepskyblue4", alpha=0.7)+
facet_wrap(~country)
white_shark %>%
count(country) %>%
arrange(desc(n)) %>%
head(5) %>%
filter(fatal_y_n=="Y" | fatal_y_n=="N") %>%
ggplot(aes(x=fatal_y_n))+
geom_bar(fill="deepskyblue4", alpha=0.7)+
facet_wrap(~country)
white_shark %>%
count(country) %>%
arrange(desc(n)) %>%
head(5) %>%
filter(fatal_y_n=="Y" | fatal_y_n=="N") %>%
ggplot(aes(x=fatal_y_n, fill = fatal_y_n))+
geom_bar()+
facet_wrap(~country)
white_shark %>%
filter(country == "USA", "AUSTRALIA", "SOUTH AFRICA", "NEW ZEALAND", "ITALY") %>%
filter(fatal_y_n=="Y" | fatal_y_n=="N") %>%
ggplot(aes(x=fatal_y_n, fill = fatal_y_n))+
geom_bar()+
facet_wrap(~country)
white_shark %>%
filter(country == "USA"| country ==  "AUSTRALIA" | country == "SOUTH AFRICA" | country == "NEW ZEALAND" | country ==  "ITALY") %>%
filter(fatal_y_n=="Y" | fatal_y_n=="N") %>%
ggplot(aes(x=fatal_y_n, fill = fatal_y_n))+
geom_bar()+
facet_wrap(~country)
white_shark %>%
filter(country == "USA"| country ==  "AUSTRALIA" | country == "SOUTH AFRICA" | country == "NEW ZEALAND" | country ==  "ITALY") %>%
filter(fatal_y_n=="Y" | fatal_y_n=="N") %>%
ggplot(aes(x=fatal_y_n, fill = fatal_y_n))+
geom_bar()+
facet_wrap(~country)+
labs(title = "Incident by country",
x = "Fatality",
y = "Incident number",
fill = "Fatality")
View(global_sharks)
global_sharks %>%
filter(fatal_y_n=="Y") %>%
count(year) %>%
arrange(desc(n))
global_sharks %>%
filter(year != "NA") %>%
filter(fatal_y_n=="Y") %>%
count(year) %>%
arrange(desc(n))
global_sharks %>%
filter(year != "NA") %>%
filter(fatal_y_n=="Y") %>%
count(year) %>%
arrange(desc(n)) %>%
head(10) %>%
ggplot(aes(x = year, y =n, fill = year))+
geom_col()+
labs(title = "Top 10 incident year",
x = "Year",
y = "Number of incident",
fill = "Year")
global_sharks %>%
filter(year != "NA") %>%
filter(fatal_y_n=="Y") %>%
count(year) %>%
arrange(desc(n)) %>%
head(10)
global_sharks %>%
filter(year != "NA") %>%
filter(fatal_y_n=="Y") %>%
count(year) %>%
arrange(desc(n)) %>%
head(5) %>%
ggplot(aes(x = year, y =n, fill = year))+
geom_col()+
labs(title = "Top 5 incident year",
x = "Year",
y = "Number of incident",
fill = "Year")
global_sharks %>%
filter(year != "NA") %>%
filter(fatal_y_n=="Y") %>%
count(year) %>%
arrange(desc(n)) %>%
head(5) %>%
ggplot(aes(x = n, y =year, fill = year))+
geom_col()+
labs(title = "Top 5 incident year",
x = "Year",
y = "Number of incident",
fill = "Year")
global_sharks %>%
filter(year != "NA") %>%
filter(fatal_y_n=="Y") %>%
count(year) %>%
arrange(desc(n)) %>%
head(5) %>%
ggplot(aes(x=year))+
geom_col()+
labs(title = "Top 5 incident year",
x = "Year",
y = "Number of incident",
fill = "Year")
global_sharks %>%
filter(year != "NA") %>%
filter(fatal_y_n=="Y") %>%
count(year) %>%
arrange(desc(n)) %>%
head(5) %>%
ggplot(aes(x=year))+
geom_bar()+
labs(title = "Top 5 incident year",
x = "Year",
y = "Number of incident",
fill = "Year")
global_sharks %>%
filter(year != "NA") %>%
filter(fatal_y_n=="Y") %>%
count(year) %>%
arrange(desc(n)) %>%
head(5)
global_sharks %>%
filter(year == 1959 | year = 1956 | year == 1958 | year == 2000 | year == 1944) %>%
global_sharks %>%
filter(year == 1959 | year == 1956 | year == 1958 | year == 2000 | year == 1944) %>%
ggplot(aes(x=year))+
geom_bar()+
labs(title = "Top 5 incident year",
x = "Year",
y = "Number of incident",
fill = "Year")
labs(title = "Top 5 incident year",
x = "Year",
y = "Number of incident",
fill = "Year")
global_sharks %>%
filter(year == 1959 | year == 1956 | year == 1958 | year == 2000 | year == 1944) %>%
ggplot(aes(x=year))+
geom_bar()+
coord_flip()
labs(title = "Top 5 incident year",
x = "Year",
y = "Number of incident",
fill = "Year")
global_sharks %>%
filter(year == 1959 | year == 1956 | year == 1958 | year == 2000 | year == 1944) %>%
ggplot(aes(x=year, fill = year))+
geom_bar()+
coord_flip()
labs(title = "Top 5 incident year",
x = "Year",
y = "Number of incident",
fill = "Year")
global_sharks %>%
filter(year == 1959 | year == 1956 | year == 1958 | year == 2000 | year == 1944) %>%
ggplot(aes(x=year, color = year))+
geom_bar()+
coord_flip()
labs(title = "Top 5 incident year",
x = "Year",
y = "Number of incident",
fill = "Year")
global_sharks %>%
filter(year == 1959 | year == 1956 | year == 1958 | year == 2000 | year == 1944) %>%
ggplot(aes(x=year, fill= year))+
geom_bar()+
coord_flip()
labs(title = "Top 5 incident year",
x = "Year",
y = "Number of incident",
fill = "Year")
global_sharks %>%
filter(year == 1959 | year == 1956 | year == 1958 | year == 2000 | year == 1944) %>%
ggplot(aes(x=year, fill= year))+
geom_bar()+
coord_flip()
labs(title = "Top 5 incident year",
x = "Year",
y = "Number of incident")
global_sharks %>%
filter(year == 1959 | year == 1956 | year == 1958 | year == 2000 | year == 1944) %>%
ggplot(aes(x=year, fill= year))+
geom_bar()+
coord_flip()+
labs(title = "Top 5 incident year",
x = "Year",
y = "Number of incident")
global_sharks %>%
filter(sex == "M" | sex == "F") %>%
filter(age != "NA") %>%
ggplot(aes(x = sex, y = age, filter = sex))+
geom_boxplot(na.rm =T)+
labs(title = "Incidents group by age range",
x = "Sex",
y = "Age range",
fill = "Sex")
global_sharks %>%
filter(sex == "M" | sex == "F") %>%
mutate(age = as.integer(age)) %>%
filter(age != "NA") %>%
ggplot(aes(x = sex, y = age, filter = sex))+
geom_boxplot(na.rm =T)+
labs(title = "Incidents group by age range",
x = "Sex",
y = "Age range",
fill = "Sex")
