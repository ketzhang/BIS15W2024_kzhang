x = "Type of injuries",
y = "Number of Injuries",
fill = "Type of injuries")
new_sh %>%
filter(incident_num != "NA") %>%
count(mode, sort=T) %>%
ggplot(aes(x=mode, y=n, fill=mode))+
geom_col()+
facet_wrap(~mode)+
coord_flip()+
labs(title = "Number and types of injuries by activity",
x = "Type of injuries",
y = "Number of Injuries",
fill = "Type of injuries")
new_sh %>%
filter(incident_num != "NA") %>%
count(species)
new_sh %>%
filter(incident_num != "NA") %>%
count(species) %>%
arrange(desc(n, na.rm=T))
new_sh %>%
filter(incident_num != "NA") %>%
count(species) %>%
arrange(desc(n))
new_sh %>%
filter(incident_num != "NA") %>%
count(mode, sort=T) %>%
ggplot(aes(x=mode, y=n, fill=mode))+
geom_col()+
facet_wrap(~mode)+
coord_flip()+
labs(title = "Number and types of injuries by activity",
x = "Type of injuries",
y = NULL,
fill = "Type of injuries")
new_sh %>%
filter(incident_num != "NA") %>%
count(mode, sort=T) %>%
ggplot(aes(x=mode, y=n, fill=mode))+
geom_col()+
facet_wrap(~mode)+
labs(title = "Number and types of injuries by activity",
x = "Type of injuries",
y = NULL,
fill = "Type of injuries")
new_sh %>%
filter(incident_num != "NA") %>%
count(mode, sort=T) %>%
ggplot(aes(x=mode, y=n, fill=mode))+
geom_col()+
facet_wrap(~mode)+
labs(title = "Number and types of injuries by activity",
x = "Type of injuries",
y = "Number of Injuries",
fill = "Type of injuries")
new_sh %>%
filter(incident_num != "NA") %>%
count(mode, sort=T) %>%
ggplot(aes(x=mode, y=n, fill=mode))+
geom_col()+
facet_wrap(~mode)+
coord_flip()
labs(title = "Number and types of injuries by activity",
x = "Type of injuries",
y = "Number of Injuries",
fill = "Type of injuries")
new_sh %>%
filter(incident_num != "NA") %>%
count(mode, sort=T) %>%
ggplot(aes(x=mode, y=n, fill=mode))+
geom_col()+
facet_wrap(~mode)+
coord_flip()
labs(title = "Number and types of injuries by activity",
x = "Type of injuries",
y = "Number of Injuries",
fill = "Type of injuries")
new_sh %>%
filter(incident_num != "NA") %>%
count(mode, sort=T) %>%
ggplot(aes(x=mode, y=n, fill=mode))+
geom_col()+
facet_wrap(~mode)+
coord_flip()+
labs(title = "Number and types of injuries by activity",
x = "Type of injuries",
y = "Number of Injuries",
fill = "Type of injuries")
new_sh %>%
filter(incident_num != "NA") %>%
count(month, sort=T) %>%
arrange(desc(n)) %>%
ggplot(aes(x = month, y = n, group= month))+
geom_line()+
labs(title = "California Shark Incidents",
x = "Number of incidents",
y = "Month",
fill = "Month")
new_sh %>%
filter(incident_num != "NA") %>%
count(month, sort=T) %>%
arrange(desc(n)) %>%
ggplot(aes(x = month, y = n, group= month))+
geom_line()+
labs(title = "California Shark Incidents",
x = "Number of incidents",
y = "Month",
fill = "Month")
new_sh %>%
filter(incident_num != "NA") %>%
count(month, sort=T) %>%
arrange(desc(n)) %>%
ggplot(aes(x = month, y = n, group= month))+
geom_boxplot()+
labs(title = "California Shark Incidents",
x = "Number of incidents",
y = "Month",
fill = "Month")
new_sh %>%
filter(incident_num != "NA") %>%
count(month, sort=T) %>%
arrange(desc(n)) %>%
ggplot(aes(x = month, y = n, group= month))+
geom_col()+
labs(title = "California Shark Incidents",
x = "Number of incidents",
y = "Month",
fill = "Month")
new_sh %>%
filter(incident_num != "NA") %>%
filter(species == "White")
new_sh %>%
filter(incident_num != "NA") %>%
filter(species == "White")
new_sh %>%
filter(incident_num != "NA") %>%
filter(species == "White") %>%
```
new_sh %>%
filter(incident_num != "NA") %>%
filter(species == "White")
new_sh %>%
filter(incident_num != "NA") %>%
filter(species == "White") %>%
count(injury, sort=T)
ggplot(aes(x=injury, y=n))+
geom_col()
ggplot(aes(x=injury))+
geom_bar()
ggplot(aes(x=injury))+
geom_bar()
new_sh %>%
filter(incident_num != "NA") %>%
filter(species == "White") %>%
count(injury, sort=T)+
ggplot(aes(x=injury))+
geom_bar()
new_sh %>%
filter(incident_num != "NA") %>%
filter(species == "White") %>%
count(injury, sort=T)+
ggplot(aes(x=injury, y=n))+
geom_col()
new_sh %>%
filter(incident_num != "NA") %>%
filter(species == "White")
new_sh %>%
filter(incident_num != "NA") %>%
filter(species == "White") %>%
group_by(injury)+
ggplot(aes(x=injury, y=n))+
geom_col()
new_sh %>%
filter(incident_num != "NA") %>%
filter(species == "White") %>%
group_by(injury)
new_sh %>%
filter(incident_num != "NA") %>%
filter(species == "White") %>%
group_by(injury)+
count(injury, sort=T)
new_sh %>%
filter(incident_num != "NA") %>%
filter(species == "White") %>%
group_by(species) %>%
ggplot(aes(x=species, y = injury))+
geom_col()
geom_bar()
white_sharks <- read_csv("data/White sharks tracked from Southeast Farallon Island, CA, USA, 1999 2004.csv", na = c("?", "n/a")) %>% clean_names()
str(white_sharks)
miss_var_summary(white_sharks)
white_sharks %>%
filter(sex !="NA") %>%
group_by(sex) %>%
summarize(avg = mean(total_length_cm, na.rm = T))
white_sharks %>%
filter(sex != "NA") %>%
group_by(sex) %>%
ggplot(aes(x = sex, y = total_length_cm, fill=sex))+
geom_boxplot(na.rm=T)+
labs(title = "Range of length by sex",
x = "Sex",
y = "Total length",
fill = "Sex")
new_sh %>%
filter(incident_num != "NA") %>%
filter(species == "White") %>%
```
new_sh %>%
filter(incident_num != "NA") %>%
filter(species == "White")
new_sh %>%
filter(incident_num != "NA") %>%
filter(species == "White") %>%
group_by(injury) %>%
ggplot(aes(x=injury))+
geom_bar()
new_sh %>%
filter(incident_num != "NA") %>%
filter(species == "White") %>%
group_by(injury) %>%
ggplot(aes(x=injury, fill = injury))+
geom_bar()
new_sh %>%
filter(incident_num != "NA") %>%
filter(species == "White") %>%
group_by(injury) %>%
ggplot(aes(x=injury, fill = injury))+
geom_bar()+
labs(title = "Great White Sharks Injuries",
x = "Type of Injuries",
y = "Injury count"
fill = "Type of Injuries")
new_sh %>%
filter(incident_num != "NA") %>%
filter(species == "White") %>%
group_by(injury) %>%
ggplot(aes(x=injury, fill = injury))+
geom_bar()+
labs(title = "Great White Sharks Injuries",
x = "Type of Injuries",
y = "Injury count",
fill = "Type of Injuries")
View(white_sharks)
View(sharks)
white_sharks %>%
group_by(sex) %>%
ggplot(aes(x=sex, y = maturity))+
geom_density()
geom_density()
white_sharks %>%
group_by(maturity)
white_sharks %>%
group_by(maturity) %>%
count(maturity, sory=T)
geom_density()
geom_boxplot()
geom_col()
geom_col()
white_sharks %>%
group_by(maturity) %>%
count(maturity)
white_sharks %>%
group_by(maturity) %>%
count(maturity) %>%
ggplot(aes(x=maturity, y=n))+
geom_col()
geom_col()
geom_boxplot()
geom_boxplot()
white_sharks %>%
group_by(maturity) %>%
count(maturity) %>%
geom_boxplot()
What is the distribution of maturity in white_sharks data
geom_col()
geom_col()
white_sharks %>%
ggplot(aes(x = maturity)) +
geom_histogram(bins = 20)+
labs(title = "Distribution of Body Mass")
white_sharks %>%
ggplot(aes(x = maturity)) +
geom_histogram()+
labs(title = "Distribution of Body Mass")
white_sharks %>%
ggplot(aes(x = maturity)) +
geom_histogram()+
labs(title = "Distribution of Body Mass")
geom_col()
white_sharks %>%
group_by(maturity) %>%
count(maturity) %>%
ggplot(aes(x=maturity, y=n))+
geom_col()
white_sharks %>%
group_by(maturity) %>%
count(maturity) %>%
ggplot(aes(x=maturity, y=n, group=sex))+
geom_col()
white_sharks %>%
group_by(maturity) %>%
count(maturity) %>%
ggplot(aes(x=maturity, y=n))+
geom_col()
white_sharks %>%
group_by(maturity) %>%
count(maturity) %>%
ggplot(aes(x=maturity, y=n, fill=maturity))+
geom_col()
white_sharks %>%
group_by(maturity) %>%
count(maturity) %>%
ggplot(aes(x=maturity, y=n, fill=maturity))+
geom_col()+
labs(title = "Distribution of maturity",
x = "Maturity",
y = "Count")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(shiny)
library(tidyverse)
library(shiny)
library(shinydashboard)
UC_admit <- read_csv("data/UC_admit.csv")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(shiny)
library(shinydashboard)
summary(UC_admit)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(janitor)
library(dplyr)
blood_count <- read_csv("data/blood_count_dataset.csv") %>% clean_names()
glimpse(blood_count)
blood_count %>%
group_by(gender) %>%
summarize(min=min(red_blood_cells),
mean=mean(red_blood_cells),
max=max(red_blood_cells))
options(scipen = 999, digits = 2)
blood_count %>%
filter(gender == "male") %>%
select(3:9) %>%
colMeans(na.rm = TRUE)
blood_count %>%
filter(gender == "Female") %>%
select(3:9) %>%
colMeans(na.rm = TRUE)
blood_count %>%
pivot_wider(cols = 3:9, names_to = "test", values_to = "values") %>%
ggplot(aes(x = gender, y = values, fill = gender)) +
geom_boxplot() +
facet_wrap(~ test, scales = "free") +
labs(title = "Boxplot of Blood Count Tests",
x = "Test",
y = "Values")
blood_count %>%
pivot_wider(names_to = "test",
values_to = "values") %>%
ggplot(aes(x = gender, y = values, fill = gender)) +
geom_boxplot() +
facet_wrap(~ test, scales = "free") +
labs(title = "Boxplot of Blood Count Tests",
x = "Test",
y = "Values")
blood_count %>%
pivot_wider(names_from = "test",
values_from = "values") %>%
ggplot(aes(x = gender, y = values, fill = gender)) +
geom_boxplot() +
facet_wrap(~ test, scales = "free") +
labs(title = "Boxplot of Blood Count Tests",
x = "Gender",
y = "Values")
blood_count %>%
pivot_wider(names_from =  = "test",
blood_count %>%
pivot_wider(names_from =  = "test",
blood_count %>%
pivot_wider(names_from =  "test",
values_from = "values") %>%
ggplot(aes(x = gender, y = values, fill = gender)) +
geom_boxplot()+
facet_wrap(~ test) +
labs(title = "Boxplot of Blood Count Tests",
x = "Gender",
y = "Values")
blood_count %>%
pivot_wider(names_from ==  "test",
values_from == "values") %>%
ggplot(aes(x = gender, y = values, fill = gender)) +
geom_boxplot()+
facet_wrap(~ test) +
labs(title = "Boxplot of Blood Count Tests",
x = "Gender",
y = "Values")
blood_count %>%
pivot_wider(names_from = test,
values_from = values) %>%
ggplot(aes(x = gender, y = values, fill = gender)) +
geom_boxplot() +
facet_wrap(~ name, scales = "free") +
labs(title = "Boxplot of Blood Count Tests",
x = "Gender",
y = "Values")
blood_count %>%
pivot_longer(cols = 3:9, names_to = "Test", values_to = "Values") %>% # removed brackets
ggplot(aes(x = gender, y = Values, fill = gender)) + # lower case g for gender
geom_boxplot() +
facet_wrap(~ Test, scales = "free")+ # added "wrap" to facet
labs(title = "Boxplot of Blood Count Tests",
x = "Test",
y = "Values")
blood_count %>%
pivot_longer(cols = 3:9, names_to = "Test", values_to = "Values") %>%
ggplot(aes(x = gender, y = Values, fill = gender)) +
geom_boxplot() +
facet_wrap(~ Test, scales = "free")+
labs(title = "Boxplot of Blood Count Tests",
x = "Test",
y = "Values")
View(blood_count)
head(grouped_bc)
head(grouped_bc)
head(grouped_bc)
grouped_bc <- blood_count %>%
mutate(Age_Group = case_when(
age >= 20 & age <= 29 ~ "20s",
age >= 30 & age <= 39 ~ "30s",
age >= 40 & age <= 49 ~ "40s",
age >= 50 & age <= 59 ~ "50s",
age >= 60 & age <= 70 ~ "60s"))
head(grouped_bc)
grouped_bc %>%
pivot_longer(cols = 3:9, names_to = "test", values_to = "values") %>%
ggplot(aes(x = age_group, y = values, fill = age_group)) +
geom_boxplot() +
facet_wrap(~test, scales = "free") +  # Facet by the "Test" variable
labs(title = "Boxplot of Blood Count Tests by Age Group",
x = "Age Group",
y = "Values")
grouped_bc %>%
pivot_longer(cols = 3:9, names_to = "Test", values_to = "Values") %>%
ggplot(aes(x = Age_group, y = Values, fill = Age_group)) +
geom_boxplot() +
facet_wrap(~test, scales = "free") +  # Facet by the "Test" variable
labs(title = "Boxplot of Blood Count Tests by Age Group",
x = "Age Group",
y = "Values")
grouped_bc %>%
pivot_longer(cols = 3:9, names_to = "Test", values_to = "Values") %>%
ggplot(aes(x = Age_group, y = Values, fill = Age_group)) +
geom_boxplot() +
facet_wrap(~Test, scales = "free") +  # Facet by the "Test" variable
labs(title = "Boxplot of Blood Count Tests by Age Group",
x = "Age Group",
y = "Values")
grouped_bc %>%
pivot_longer(cols = 3:9, names_to = "Test", values_to = "Values") %>%
ggplot(aes(x = Age_Group, y = Values, fill = Age_Group)) +
geom_boxplot() +
facet_wrap(~Test, scales = "free") +  # Facet by the "Test" variable
labs(title = "Boxplot of Blood Count Tests by Age Group",
x = "Age Group",
y = "Values")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(janitor)
library(dplyr)
blood_count <- read_csv("data/blood_count_dataset.csv") %>% clean_names()
glimpse(blood_count)
blood_count %>%
group_by(gender) %>%
summarize(min=min(red_blood_cells),
mean=mean(red_blood_cells),
max=max(red_blood_cells))
options(scipen = 999, digits = 2)
blood_count %>%
filter(gender == "male") %>%
select(3:9) %>%
colMeans(na.rm = TRUE)
blood_count %>%
filter(gender == "Female") %>%
select(3:9) %>%
colMeans(na.rm = TRUE)
blood_count %>%
pivot_longer(cols = 3:9, names_to = "Test", values_to = "Values") %>%
ggplot(aes(x = gender, y = Values, fill = gender)) +
geom_boxplot() +
facet_wrap(~ Test, scales = "free")+
labs(title = "Boxplot of Blood Count Tests",
x = "Test",
y = "Values")
grouped_bc <- blood_count %>%
mutate(Age_Group = case_when(
age >= 20 & age <= 29 ~ "20s",
age >= 30 & age <= 39 ~ "30s",
age >= 40 & age <= 49 ~ "40s",
age >= 50 & age <= 59 ~ "50s",
age >= 60 & age <= 70 ~ "60s")) # there were only 4 people in 70s, so I combined it with 60s
head(grouped_bc)
grouped_bc %>%
pivot_longer(cols = 3:9, names_to = "Test", values_to = "Values") %>%
ggplot(aes(x = Age_Group, y = Values, fill = Age_Group)) +
geom_boxplot() +
facet_wrap(~Test, scales = "free") +  # Facet by the "Test" variable
labs(title = "Boxplot of Blood Count Tests by Age Group",
x = "Age Group",
y = "Values")
